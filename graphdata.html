
<html>
 <head>
  <title>Google Chart</title>
 </head>
 
 <script src="https://www.puck-js.com/puck.js"></script>
 <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
 <div id="chart_div"></div>
  <script>

google.charts.load('current', {packages: ['corechart', 'line']});
google.charts.setOnLoadCallback(time_chart);
   
   

function time_chart() {
  
      var direction = 10;
      var data = new google.visualization.DataTable();
      data.addColumn('number', 'X');
      data.addColumn('number', 'Pressure');

      var index=0;
   
     function onLine(v) {
           data.addRows(1);
           data.setCell(index, 0, index);
           data.setCell(index, 1, v);
           index++;
     } 
 
 Puck.connect(function(c) {
        alert("In Puck connect");
          if (!c) {
          alert("Couldn't connect!");
          return;
        }
        connection = c;
        // Handle the data we get back, and call 'onLine'
        // whenever we get a line
        var buf = "";
        connection.on("data", function(d) {
          buf += d;
          var i = buf.indexOf("\n");
          while (i>=0) {
            onLine(buf.substr(0,i));
            buf = buf.substr(i+1);
            i = buf.indexOf("\n");
          }
        }); // connection.on () 
    }); // End Puck.connect () 
 
 alert("Before readpressure()");
 
  /*
    alert("Before readpressure()");
    connection.write("setInterval(function(){Bluetooth.println(readpressure());} ,100); \n",
              function() { console.log("Ready..."); });  // end connection write 

     for(k=0; k<80; k++) {
           onLine(k*10);
     };
 */
 
     var options = {
       height: 500,
       chartArea: {
          height: '80%',
          width: '80%',
          top: '5%',
          left: '5%'
        }, 
       hAxis: {
          ticks: [0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100],
          viewWindow: {min:0, max:100},
          title: 'Time'
        },
        vAxis: {
          ticks: [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000, 1100],
          gridlines: {color: '#ccc'},
          title: 'Pressure'
        }
      };
 
      var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
 
      google.visualization.events.addListener(chart, 'select', selectHandler);
      
      function selectHandler () {
         options.hAxis.viewWindow.min += direction;
         options.hAxis.viewWindow.max += direction;
         chart.draw(data, options);
      };     
 
      chart.draw(data, options);
}
   
  </script>
 </body>
</html>
